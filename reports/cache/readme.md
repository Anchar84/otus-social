# Отчет по домашнему заданию кеширование.

### Архитектура и алгоритмы работы с кешем

Реализован отдельный сервис постов хранения пользователей. 
Кеш ленты постов друзей хранится в redis. 
Используется подход формирования ленты при записи (https://habr.com/ru/companies/dataart/articles/242593/),
то есть по событиям:
- создания поста
- редактирования поста
- удаления поста
- добавление друзей
- удаление друзей

происходит формирование готовой ленты постов нужных пользователей (тех, кто подписан на посты автора 
или в случае подписки / отписки на автора), готовая лента новостей сохраняется в redis и в дальнейшем 
возвращается из нет (с учетом параметров offset и limit). Лента постов состоит из не более 1000 последних 
постов авторов, на которых подписан пользователе

Формирование ленты запускается с помощью брокера, то есть при вызове соответствующих ендпоинтов в брокер для каждого
подписчика автора (или самого пользователя, если он подписывается / отписывается на автора) отправляется
событие о необходимости переформирования ленты постов

Для прогрева кеша при старте сервиса постов проверяется количество готовых лент постов и если кеш пустой по таблице
друзей (подписок) в брокер отправляются соответствующие события

### стек технологий и модулей
- модуль пользователей - хранит информацию о пользователях, отвечает за авторизацию
- модуль постов - хранит посты и информацию по подписках
- postgres - содержит две реляционные базы для модулей пользователей и постов
- rabbitmq - брокер сообщений, используется для асинхронного запуска формирование кеша ленты постов (для каждого подписчика отдельное событие)
- redis - кеш ленты постов

для авторизации пользовательских запросов используется jwt, то есть чтобы выполнить запрос необходимо сначала 
авторизоваться в модуле пользователей (при успешной авторизации возвращается токен) и далее полученный токен добавлять во все 
запросы в заголовок **X-Auth**

Запросы можно посмотреть в постман коллекции _postman_collection.json_
Для запуска проекта можно использовать _docker-compose.yml_
